---
title: "[Next.js] Next-Auth"
date: 2024-04-23 14:33:00 +09:00
categories: [Development, Next.js]
tags: [Development, Windows, javaScript, typeScript, React, Next.js, Auth.js, Web, Front-end]
---
## **1. 시작하며**
***
이번 포스팅에서는 Next.js로 프로젝트를 진행하는 경우, 사용자 인증 정보를 서버 측 세션으로 관리할 수 있게 해 주는 NextAuth 라이브러리에 관해 정리해보려고 한다. JWT(Jason Web Token)을 비롯한 사용자 인증 정보는 어쨌든 암호화라는 과정을 거치지만, 클라이언트 측에서 관리해야 하기 때문에 보안 키가 노출되는 경우 보안에 취약하다라는 명확한 단점이 있다. NextAuth를 활용하게 되면 사용자 인증 정보를 클라이언트 측이 아니라, Next에서 제공하는 인증 서버에 저장하고 세션으로 관리할 수 있다. 뿐만 아니라, 기본적으로 제공하는 함수들을 활용하면 훨씬 쉽게 사용자 정보를 관리할 수 있다.
<br>

## **2. Auth.js**
***
2024년 4월 23일을 기준으로, 현재의 라이브러리는 v5 버전이 개발 중이고, Beta 버전으로 테스트가 진행 중이다. v5부터는 라이브러리의 이름도 Auth.js로 바꼈고, NextAuth.js를 검색하면 기존의 v4 버전의 NextAuth.js에 관한 문서를 제공하고 있다. 그래서 애초에 v5 버전의 Auth를 사용하고 싶다면 검색 자체도 Auth.js로 검색을 해야 해당 문서를 확인할 수 있고 기존의 Next-Auth에서 v5으로의 마이그레이션도 가능하도록 안내하고는 있지만, 어쨌든 여전히 베타버전이라는 점에서 믿음이 안 가는 것도 사실이다.
<br>

## **3. 사용 방법**
***
설치는 상대적으로 간단하다. 앞서 설명한대로 v5 베타 버전을 사용하고 싶다면 Auth.js를 검색하면 되고, 어느 정도 검증된 v4 버전의 Next-Auth를 사용하고 싶다면 NextAuth.js로 검색하면 공식 문서를 제공하고 있다. 공식문서를 확인하면 친절하게 다양한 패키지 매니저 별 설치 방법을 제공하고 있으니, 개발 환경 별로 프로젝트에 맞게 사용하면 되겠다.

### **(1) Route 핸들러 설정**


<br>

## **4. 세션**
***
클라이언트가 로그인한 정보를 서버가 갖고 있게 되는 것을 의미한다. 누가 어디서 어떻게 접속했는지에 관한 정보들을 담는다.

중복 로그인을 방지하기 위해서는 세션을 사용해야 한다. 중복 접근을 하게 되면 기존의 세션을 서버에서 삭제하고 새로운 세션을 생성해서 저장하는 구조이다.
<br>

## **5. 토큰**
***
로그인을 실제로 하게 되면 서버에는 아무것도 저장하지 않고, 인증키를 유저에게 부여하게 되는 것이다. 세션과 다른 점은, 서버에 아무 정보가 없다는 것이다(데이터베이스에서 뽑아낼 수 있는 데이터가 없다).

문제는, 토큰에는 토큰을 사용하는 유저와 토큰을 발급받은 유저가 같은지 아닌지 여부를 검증하는 시스템이 없기 때문에, 토큰을 탈취당하는 그 즉시 다른 유저들이 사용할 수 있다. 편리하면 그만큼 보안이 취약하다는 것을 유의해야 한다.
<br>

## **6. JWT(Json Web Token)**
***
![Imgur](https://i.imgur.com/FNBulNl.png)


### 1. 기본 설정


<br>
